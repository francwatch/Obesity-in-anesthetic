<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Anesthetics for obese patients (demo)</title>
  <style>
    :root{
      --bg:#f2f4f7;
      --card:#ffffff;
      --text:#0f172a;
      --muted:#64748b;
      --border:#e5e7eb;
      --shadow:0 10px 28px rgba(15, 23, 42, .12);

      --yellow:#fff3b0;
      --blue:#bfe6f6;
      --red:#ffb2b7;
      --purple:#d6c9ff;
      --green:#dff7cf;
      --soft:#fff7e6;

      --btn:#16a34a;
      --btn2:#9ca3af;

      --switchOff:#cbd5e1;
      --switchOn:#3b82f6;
    }

    *{ box-sizing:border-box; font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial; }
    body{ margin:0; background:var(--bg); color:var(--text); }
    .wrap{ max-width:520px; margin: 26px auto 60px; padding: 0 14px; }

    /* header */
    .top{
      display:flex; align-items:center; justify-content:center;
      gap:12px; margin-bottom:10px;
    }
    .logoImg{
  width:52px;
  height:52px;
  border-radius:50%;   /* remove if you want full logo, no circle */
  object-fit:cover;
  background:#fff;
  box-shadow:0 8px 18px rgba(0,0,0,.12);
    }

    h1{ margin:0; font-size:20px; text-align:center; }
    .sub{ text-align:center; margin:6px 0 18px; color:var(--muted); font-size:13px; }

    /* main input card */
    .card{
      background:var(--card);
      border:1px solid var(--border);
      border-radius:14px;
      box-shadow:var(--shadow);
      padding:16px;
    }
    .row{ display:flex; gap:12px; }
    .row > div{ flex:1; }
    label{ display:block; font-size:13px; color:var(--muted); margin-bottom:6px; }
    input{
      width:100%;
      padding:10px 12px;
      border-radius:10px;
      border:1px solid var(--border);
      font-size:15px;
      background:#fff;
    }

    /* segmented gender */
    .seg{
      display:flex; gap:10px;
      margin-bottom:12px;
    }
    .seg button{
      flex:1;
      padding:10px 12px;
      border-radius:10px;
      border:1px solid var(--border);
      background:#fff;
      font-weight:700;
      cursor:pointer;
      user-select:none;
    }
    .seg button.active{
      background:#3b82f6;
      border-color:#3b82f6;
      color:#fff;
    }

    /* action buttons */
    .actions{ display:flex; gap:10px; margin-top:12px; }
    .btn{
      padding:10px 14px;
      border-radius:8px;
      border:1px solid transparent;
      font-weight:800;
      cursor:pointer;
      user-select:none;
    }
    .btn.calc{ background:var(--btn); color:#fff; }
    .btn.reset{ background:var(--btn2); color:#fff; }

    /* BMI line */
    .meta{
      margin: 16px 0 8px;
      display:grid;
      gap:6px;
    }
    .metaRow{
      display:flex; justify-content:space-between; align-items:center;
      padding: 0 4px;
      font-size:14px;
    }
    .metaRow b{ font-weight:900; }
    .metaVal{ font-weight:900; color:#1d4ed8; }

    /* Sections */
    .section{
      border-radius:12px;
      overflow:hidden;
      border:1px solid var(--border);
      margin-top:10px;
      background:#fff;
    }
    .secHead{
      padding:10px 12px;
      display:flex; align-items:center; justify-content:space-between;
      font-weight:900;
    }
    .secBody{ padding: 8px 8px 10px; display:grid; gap:8px; }

    .pill{
      border-radius:10px;
      padding:10px 12px;
      display:flex; justify-content:space-between; gap:14px;
      align-items:flex-start;
      border:1px solid rgba(0,0,0,.06);
    }
    .leftTitle{ font-weight:800; }
    .hint{ display:block; margin-top:3px; font-size:12px; color:#334155; opacity:.85; }
    .dose{ font-weight:900; color:#0b3aa4; white-space:nowrap; }

    /* color themes */
    .yellow .secHead, .yellow .pill{ background:var(--yellow); }
    .blue   .secHead, .blue   .pill{ background:var(--blue); }
    .red    .secHead, .red    .pill{ background:var(--red); }
    .purple .secHead, .purple .pill{ background:var(--purple); }
    .green  .pill{ background:var(--green); }
    .soft   .pill{ background:var(--soft); }

    /* iOS-style switch */
    .switch{ position:relative; width:46px; height:26px; display:inline-block; }
    .switch input{ display:none; }
    .slider{
      position:absolute; inset:0;
      background:var(--switchOff);
      border-radius:999px;
      transition:.2s;
    }
    .slider:before{
      content:"";
      position:absolute;
      height:20px; width:20px;
      top:3px; left:3px;
      background:#fff;
      border-radius:999px;
      transition:.2s;
      box-shadow:0 2px 7px rgba(0,0,0,.25);
    }
    .switch input:checked + .slider{ background:var(--switchOn); }
    .switch input:checked + .slider:before{ transform: translateX(20px); }

    /* equations block */
    .equations{
      background:#fff;
      border:1px dashed rgba(0,0,0,.25);
      border-radius:12px;
      padding:12px;
      font-size:12.5px;
      color:#334155;
      line-height:1.5;
    }
    .equations code{
      background:#f8fafc;
      border:1px solid var(--border);
      padding:2px 6px;
      border-radius:8px;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
      font-size:12px;
      white-space:nowrap;
    }

    /* footer */
    footer{
      margin-top:18px;
      text-align:center;
      font-size:12px;
      color:#6b7280;
      line-height:1.6;
    }
    .warn{
      color:#b91c1c;
      font-weight:900;
    }
  </style>
</head>

<body>
  <div class="wrap">
  <div class="top">
    <img src="anesCULogo.png"
         alt="Chulalongkorn Anesthesiology Logo"
         class="logoImg">
    <div>
      <h1>Anesthetics for obese patients</h1>
      <div class="sub">
        Demo calculator (BMI ‚â• 30). Use clinical judgment.
      </div>
    </div>
  </div>
</div>



    <!-- INPUT CARD -->
    <div class="card">
      <label>Gender :</label>
      <div class="seg">
        <button id="maleBtn" type="button">üë®üèª Male</button>
        <button id="femaleBtn" class="active" type="button">üë©üèª Female</button>
      </div>

      <div class="row">
        <div>
          <label>Weight (kg):</label>
          <input id="w" type="number" step="0.1" value="59">
        </div>
        <div>
          <label>Height (cm):</label>
          <input id="h" type="number" step="0.1" value="140">
        </div>
      </div>

      <div class="actions">
        <button class="btn calc" id="calcBtn" type="button">Calculate</button>
        <button class="btn reset" id="resetBtn" type="button">Reset</button>
      </div>
    </div>

    <!-- BMI SUMMARY -->
    <div class="meta">
      <div class="metaRow"><b>BMI</b><span class="metaVal" id="bmiVal">‚Äî</span></div>
      <div class="metaRow"><b>Category</b><span class="metaVal" id="bmiCat">‚Äî</span></div>
    </div>

    <!-- 1 Propofol -->
    <div class="section yellow">
      <div class="secHead">
        <div>1. Propofol</div>
        <label class="switch">
          <input type="checkbox" id="togProp" checked>
          <span class="slider"></span>
        </label>
      </div>
      <div class="secBody" id="propBody">
        <div class="pill">
          <div>
            <span class="leftTitle">Induction</span>
            <span class="hint">(1.5‚Äì2.5 mg/kg LBW)</span>
          </div>
          <div class="dose" id="propInd">‚Äî</div>
        </div>
        <div class="pill">
          <div>
            <span class="leftTitle">Infusion (GA)</span>
            <span class="hint">(100‚Äì200 mcg/kg/min AdjBW)</span>
          </div>
          <div class="dose" id="propGA">‚Äî</div>
        </div>
        <div class="pill">
          <div>
            <span class="leftTitle">Infusion (Sedation)</span>
            <span class="hint">(25‚Äì100 mcg/kg/min AdjBW)</span>
          </div>
          <div class="dose" id="propSed">‚Äî</div>
        </div>
      </div>
    </div>

    <!-- 2 Fentanyl -->
    <div class="section blue">
      <div class="secHead">
        <div>2. Fentanyl</div>
        <label class="switch">
          <input type="checkbox" id="togFent" checked>
          <span class="slider"></span>
        </label>
      </div>
      <div class="secBody" id="fentBody">
        <div class="pill">
          <div>
            <span class="leftTitle">Fentanyl</span>
            <span class="hint">(1‚Äì2 mcg/kg LBW)</span>
          </div>
          <div class="dose" id="fentBolus">‚Äî</div>
        </div>
      </div>
    </div>

    <!-- 3 Muscle relaxant -->
    <div class="section red">
      <div class="secHead">
        <div>3. Muscle relaxant</div>
        <label class="switch">
          <input type="checkbox" id="togNMB" checked>
          <span class="slider"></span>
        </label>
      </div>
      <div class="secBody" id="nmbBody">
        <div class="pill">
          <div>
            <span class="leftTitle">Succinylcholine</span>
            <span class="hint">(1 mg/kg TBW)</span>
          </div>
          <div class="dose" id="sux">‚Äî</div>
        </div>
        <div class="pill">
          <div>
            <span class="leftTitle">Atracurium</span>
            <span class="hint">(0.6 mg/kg LBW)</span>
          </div>
          <div class="dose" id="atra">‚Äî</div>
        </div>
        <div class="pill">
          <div>
            <span class="leftTitle">Cisatracurium</span>
            <span class="hint">(0.15 mg/kg LBW)</span>
          </div>
          <div class="dose" id="cisa">‚Äî</div>
        </div>
        <div class="pill">
          <div>
            <span class="leftTitle">Rocuronium</span>
            <span class="hint">(0.6‚Äì0.9 mg/kg LBW)</span>
          </div>
          <div class="dose" id="rocu">‚Äî</div>
        </div>
      </div>
    </div>

    <!-- 4 Reversal agent -->
    <div class="section soft">
      <div class="secHead">
        <div>4. Reversal agent</div>
        <label class="switch">
          <input type="checkbox" id="togRev" checked>
          <span class="slider"></span>
        </label>
      </div>
      <div class="secBody" id="revBody">
        <div class="pill soft" style="border:1px dashed rgba(185,28,28,.7)">
          <div>
            <span class="leftTitle">Neostigmine</span>
            <span class="hint">(0.05 mg/kg AdjBW)</span>
          </div>
          <div class="dose" id="neo">‚Äî</div>
        </div>

        <div class="pill green">
          <div>
            <span class="leftTitle">Atropine</span>
            <span class="hint">(0.02 mg/kg AdjBW)</span>
          </div>
          <div class="dose" id="atrop">‚Äî</div>
        </div>

        <div class="pill green">
          <div>
            <span class="leftTitle">Glycopyrrolate</span>
            <span class="hint">(0.01 mg/kg AdjBW)</span>
          </div>
          <div class="dose" id="glyco">‚Äî</div>
        </div>

        <div class="pill soft" style="border:1px dashed rgba(185,28,28,.7)">
          <div>
            <span class="leftTitle">Sugammadex</span>
            <span class="hint">(2‚Äì4 mg/kg AdjBW)</span>
          </div>
          <div class="dose" id="suga">‚Äî</div>
        </div>
      </div>
    </div>

    <!-- 5 Other meds -->
    <div class="section purple">
      <div class="secHead">
        <div>5. Other medications</div>
        <label class="switch">
          <input type="checkbox" id="togOther" checked>
          <span class="slider"></span>
        </label>
      </div>
      <div class="secBody" id="otherBody">
        <div class="pill">
          <div><span class="leftTitle">Etomidate</span><span class="hint">(0.2‚Äì0.3 mg/kg LBW)</span></div>
          <div class="dose" id="eto">‚Äî</div>
        </div>
        <div class="pill">
          <div><span class="leftTitle">Thiopental</span><span class="hint">(3‚Äì5 mg/kg LBW)</span></div>
          <div class="dose" id="thio">‚Äî</div>
        </div>
        <div class="pill">
          <div><span class="leftTitle">Ketamine (bolus)</span><span class="hint">(0.5‚Äì1 mg/kg LBW)</span></div>
          <div class="dose" id="keta">‚Äî</div>
        </div>
        <div class="pill">
          <div><span class="leftTitle">Midazolam</span><span class="hint">(0.05‚Äì0.1 mg/kg LBW)</span></div>
          <div class="dose" id="mida">‚Äî</div>
        </div>
        <div class="pill">
          <div><span class="leftTitle">Dexmedetomidine (loading)</span><span class="hint">(0.5‚Äì1 mcg/kg LBW)</span></div>
          <div class="dose" id="dex">‚Äî</div>
        </div>
        <div class="pill">
          <div><span class="leftTitle">Morphine</span><span class="hint">(0.05‚Äì0.1 mg/kg LBW)</span></div>
          <div class="dose" id="morph">‚Äî</div>
        </div>
      </div>
    </div>

    <!-- 6 Additional info -->
    <div class="section" style="border:none; background:transparent;">
      <div class="secHead" style="background:transparent; padding:12px 2px 8px; font-weight:900;">
        <div>6. Addition information</div>
        <label class="switch">
          <input type="checkbox" id="togInfo" checked>
          <span class="slider"></span>
        </label>
      </div>

      <div id="infoBody" style="display:grid; gap:8px;">
        <div class="pill soft">
          <div><span class="leftTitle">IBW (Ideal Body Weight)</span><span class="hint">Devine</span></div>
          <div class="dose" id="ibw">‚Äî</div>
        </div>
        <div class="pill soft">
          <div><span class="leftTitle">LBW (Lean Body Weight)</span><span class="hint">Janmahasatian</span></div>
          <div class="dose" id="lbw">‚Äî</div>
        </div>
        <div class="pill soft">
          <div><span class="leftTitle">AdjBW (Adjusted Body Weight)</span><span class="hint">IBW + 0.4√ó(TBW‚àíIBW)</span></div>
          <div class="dose" id="adj">‚Äî</div>
        </div>
        <div class="pill soft">
          <div><span class="leftTitle">PBW (Predicted Body Weight)</span><span class="hint">for ventilator setting (same as Devine)</span></div>
          <div class="dose" id="pbw">‚Äî</div>
        </div>

        <div class="equations">
          <div style="font-weight:900; margin-bottom:6px;">Equations used (shown for transparency)</div>
          <div><b>BMI</b> = <code>TBW / (height_m¬≤)</code></div>
          <div style="margin-top:6px;"><b>IBW / PBW (Devine)</b></div>
          <div>Male: <code>50 + 2.3 √ó (height_in ‚àí 60)</code></div>
          <div>Female: <code>45.5 + 2.3 √ó (height_in ‚àí 60)</code></div>
          <div style="margin-top:6px;"><b>LBW (Janmahasatian)</b></div>
          <div>Male: <code>(9270√óTBW) / (6680 + 216√óBMI)</code></div>
          <div>Female: <code>(9270√óTBW) / (8780 + 244√óBMI)</code></div>
          <div style="margin-top:6px;"><b>AdjBW</b> = <code>IBW + 0.4√ó(TBW‚àíIBW)</code></div>
        </div>
      </div>
    </div>

    <footer>
      <div class="warn">DEMO VERSION ‚Äî all calculations must be rechecked before clinical use.</div>
      <div>Not an official guideline. For education + prototyping only.</div>
      <div>¬© 2025 (your name/department here) ‚Ä¢ Version 0.1</div>
    </footer>
  </div>

<script>
  // ---------------------------
  // Core state
  // ---------------------------
  let gender = "female";

  const el = (id) => document.getElementById(id);

  // buttons
  const maleBtn = el("maleBtn");
  const femaleBtn = el("femaleBtn");
  const wInput = el("w");
  const hInput = el("h");

  function setGender(g){
    gender = g;
    maleBtn.classList.toggle("active", g==="male");
    femaleBtn.classList.toggle("active", g==="female");
  }

  maleBtn.addEventListener("click", ()=>{ setGender("male"); });
  femaleBtn.addEventListener("click", ()=>{ setGender("female"); });

  // ---------------------------
  // Weight formulas
  // ---------------------------
  function bmi(tbw, heightCm){
    const hm = heightCm/100;
    return tbw/(hm*hm);
  }

  function ibw_devine(heightCm, gender){
    const hin = heightCm/2.54;
    const base = (gender==="male") ? 50 : 45.5;
    return base + 2.3 * Math.max(0, hin - 60);
  }

  function lbw_janma(tbw, heightCm, gender){
    const B = bmi(tbw, heightCm);
    if (gender==="male") return (9270*tbw)/(6680 + 216*B);
    return (9270*tbw)/(8780 + 244*B);
  }

  function adjbw(tbw, ibw){
    return ibw + 0.4*(tbw-ibw);
  }

  // display helpers
  const r0 = (x) => Math.round(x);
  const one = (x) => Math.round(x*10)/10;

  function range(a,b,unit){ return `${r0(a)} - ${r0(b)} ${unit}`; }
  function single(x,unit){ return `${r0(x)} ${unit}`; }

  // ---------------------------
  // BMI category (matches your screenshot style)
  // ---------------------------
  function bmiCategory(B){
    if (B >= 40) return "Obese GRADE III / Morbidly Obese";
    if (B >= 35) return "Obese GRADE II";
    if (B >= 30) return "Obese GRADE I";
    return "Not obese (BMI < 30)";
  }

  // ---------------------------
  // Calculate all outputs
  // ---------------------------
  function calculate(){
    const w = Number(wInput.value);
    const h = Number(hInput.value);

    if(!w || !h){
      el("bmiVal").textContent = "‚Äî";
      el("bmiCat").textContent = "‚Äî";
      return;
    }

    const B = bmi(w,h);
    const IBW = ibw_devine(h, gender);
    const LBW = lbw_janma(w,h, gender);
    const ADJ = adjbw(w, IBW);
    const PBW = IBW; // same Devine used here

    el("bmiVal").textContent = one(B);
    el("bmiCat").textContent = bmiCategory(B);

    // 1) Propofol
    el("propInd").textContent = range(1.5*LBW, 2.5*LBW, "mg");
    // infusion: mcg/kg/min -> mg/hr
    const gaLow  = (100*ADJ)*60/1000;
    const gaHigh = (200*ADJ)*60/1000;
    el("propGA").textContent = range(gaLow, gaHigh, "mg/hr");

    const sedLow  = (25*ADJ)*60/1000;
    const sedHigh = (100*ADJ)*60/1000;
    el("propSed").textContent = range(sedLow, sedHigh, "mg/hr");

    // 2) Fentanyl
    el("fentBolus").textContent = range(1*LBW, 2*LBW, "mcg");

    // 3) NMB
    el("sux").textContent  = single(1*w, "mg");
    el("atra").textContent = single(0.6*LBW, "mg");
    el("cisa").textContent = single(0.15*LBW, "mg");
    el("rocu").textContent = range(0.6*LBW, 0.9*LBW, "mg");

    // 4) Reversal (AdjBW)
    el("neo").textContent   = single(0.05*ADJ, "mg");
    el("atrop").textContent = single(0.02*ADJ, "mg");
    el("glyco").textContent = single(0.01*ADJ, "mg");
    el("suga").textContent  = range(2*ADJ, 4*ADJ, "mg");

    // 5) Other meds (LBW-based here)
    el("eto").textContent   = range(0.2*LBW, 0.3*LBW, "mg");
    el("thio").textContent  = range(3*LBW, 5*LBW, "mg");
    el("keta").textContent  = range(0.5*LBW, 1*LBW, "mg");
    el("mida").textContent  = range(0.05*LBW, 0.1*LBW, "mg");
    el("dex").textContent   = range(0.5*LBW, 1*LBW, "mcg");
    el("morph").textContent = range(0.05*LBW, 0.1*LBW, "mg");

    // 6) Weights
    el("ibw").textContent = `${one(IBW)} kg`;
    el("lbw").textContent = `${one(LBW)} kg`;
    el("adj").textContent = `${one(ADJ)} kg`;
    el("pbw").textContent = `${one(PBW)} kg`;
  }

  // ---------------------------
  // Section toggles
  // ---------------------------
  function bindToggle(togId, bodyId){
    const t = el(togId);
    const b = el(bodyId);
    const apply = () => b.style.display = t.checked ? "grid" : "none";
    t.addEventListener("change", apply);
    apply();
  }
  bindToggle("togProp","propBody");
  bindToggle("togFent","fentBody");
  bindToggle("togNMB","nmbBody");
  bindToggle("togRev","revBody");
  bindToggle("togOther","otherBody");
  bindToggle("togInfo","infoBody");

  // ---------------------------
  // Buttons
  // ---------------------------
  el("calcBtn").addEventListener("click", calculate);

  el("resetBtn").addEventListener("click", ()=>{
    wInput.value = "";
    hInput.value = "";
    el("bmiVal").textContent = "‚Äî";
    el("bmiCat").textContent = "‚Äî";
  });

  // Optional: auto-calc when editing
  wInput.addEventListener("input", calculate);
  hInput.addEventListener("input", calculate);

  // Also recalc when switching gender
  maleBtn.addEventListener("click", calculate);
  femaleBtn.addEventListener("click", calculate);

  // Initial render
  calculate();
</script>
</body>
</html>
